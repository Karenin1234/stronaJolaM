<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zaawansowany Kreator Bloga</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            dark: {
              100: '#1E1E2D',
              200: '#2A2A3A',
              300: '#3A3A4A',
              400: '#4A4A5A',
              500: '#5A5A6A'
            },
            primary: { DEFAULT: '#6366f1', dark: '#4f46e5' },
            accent: '#f59e0b'
          }
        }
      }
    }
  </script>
  <link
    href="https://fonts.googleapis.com/css2?family=Merriweather:wght@700&family=Open+Sans:wght@400;600&family=Roboto:wght@400;700&family=Lora:wght@400;700&family=Montserrat:wght@400;700&family=Comic+Neue:wght@400;700&family=Pacifico&family=Raleway:wght@400;700&family=Oswald:wght@400;700&family=PT+Serif:wght@400;700&family=Ubuntu:wght@400;700&family=Playfair+Display:wght@400;700&family=Source+Sans+Pro:wght@400;700&family=Nunito:wght@400;700&family=Work+Sans:wght@400;700&family=Rubik:wght@400;700&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    rel="stylesheet"
  />
  <style>
    body {
      font-family: 'Open Sans', sans-serif;
    }
    .editor-toolbar {
      background: #1e1e2d;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 1rem;
      border: 1px solid #444;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
    .editor-toolbar button,
    .editor-toolbar select {
      background: #2a2a3a;
      color: #e0e0e0;
      border: 1px solid #444;
      padding: 6px 10px;
      border-radius: 6px;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .editor-toolbar button:hover,
    .editor-toolbar select:hover {
      background: #3a3a4a;
      transform: translateY(-1px);
    }
    .editor-toolbar .tool-group {
      display: flex;
      gap: 5px;
      padding: 0 5px;
      border-right: 1px solid #444;
    }
    .editor-toolbar .tool-group:last-child {
      border-right: none;
    }
    #blogContent {
      min-height: 250px;
      background: #2a2a3a;
      padding: 16px;
      border-radius: 8px;
      border: 1px solid #444;
      color: #e0e0e0;
      outline: none;
      line-height: 1.5;
    }
    .blog-container {
      background: #1e1e2d;
      border: 1px solid #333;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
      position: relative;
    }
    .hidden {
      display: none;
    }
    .cover-preview {
      max-height: 200px;
      object-fit: cover;
    }
    .media-editor {
      position: absolute;
      background: rgba(40, 40, 55, 0.95);
      border: 1px solid #6366f1;
      padding: 10px;
      border-radius: 8px;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .media-editor input {
      background: #2a2a3a;
      color: white;
      border: 1px solid #444;
      padding: 4px 8px;
      border-radius: 4px;
      width: 80px;
    }
    .tag-input {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      padding: 8px;
      background: #2a2a3a;
      border-radius: 6px;
      border: 1px solid #444;
    }
    .tag {
      background: #6366f1;
      color: white;
      padding: 3px 8px;
      border-radius: 12px;
      font-size: 0.8rem;
      display: flex;
      align-items: center;
    }
    .tag-remove {
      margin-left: 5px;
      cursor: pointer;
    }
    .tag-input input {
      flex-grow: 1;
      background: transparent;
      border: none;
      color: white;
      outline: none;
      min-width: 100px;
    }
    blockquote {
      border-left: 4px solid #f59e0b;
      padding-left: 15px;
      margin: 10px 0;
      font-style: italic;
      color: #ccc;
    }
    .custom-divider {
      border-top: 2px dashed #f59e0b;
      margin: 15px 0;
    }
    .font-preview {
      font-family: var(--font);
    }
  </style>
</head>
<body class="bg-dark-100 text-gray-200">
<div class="p-4 max-w-5xl mx-auto">
  <h1 class="text-center mb-6 text-4xl font-bold">Zaawansowany Kreator Bloga</h1>

  <div class="blog-container p-6 rounded-lg shadow-lg">
    <!-- Krok 1: Podstawowe informacje -->
    <div id="step1">
      <div class="mb-6">
        <label for="blogTitle" class="block text-sm font-medium mb-2">
          Tytuł wpisu <span class="text-red-500">*</span>
        </label>
        <input
          type="text"
          id="blogTitle"
          class="w-full p-3 rounded-md bg-dark-200 border border-dark-400 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
          placeholder="Wpisz tytuł"
          required
        />
      </div>

      <div class="mb-6">
        <label for="blogDesc" class="block text-sm font-medium mb-2">
          Opis wpisu <span class="text-red-500">*</span>
        </label>
        <textarea
          id="blogDesc"
          rows="3"
          class="w-full p-3 rounded-md bg-dark-200 border border-dark-400 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
          placeholder="Krótki opis posta..."
        ></textarea>
      </div>

      <div class="mb-6">
        <label for="blogCategory" class="block text-sm font-medium mb-2">
          Kategoria
        </label>
        <select id="blogCategory" class="w-full p-3 rounded-md bg-dark-200 border border-dark-400">
          <option value="">Wybierz kategorię</option>
          <option value="technology">Technologia</option>
          <option value="design">Design</option>
          <option value="business">Biznes</option>
          <option value="lifestyle">Lifestyle</option>
        </select>
      </div>

      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">
          Tagi
        </label>
        <div class="tag-input">
          <div id="tagsContainer" class="flex flex-wrap gap-2"></div>
          <input
            type="text"
            id="tagInput"
            placeholder="Dodaj tag..."
            class="bg-transparent border-none focus:ring-0"
          >
        </div>
      </div>

      <div class="mb-6">
        <label for="coverUpload" class="block text-sm font-medium mb-2">
          Obraz tytułowy
        </label>
        <div class="flex items-center">
          <label for="coverUpload" class="px-4 py-2 bg-primary-500 text-white rounded-l-md cursor-pointer hover:bg-primary-600">
            <i class="fas fa-upload mr-2"></i> Wybierz plik
          </label>
          <span id="coverFileName" class="px-3 py-2 bg-dark-300 rounded-r-md flex-grow truncate">Nie wybrano pliku</span>
        </div>
        <input type="file" id="coverUpload" accept="image/*" class="hidden">
        <div id="coverPreview" class="mt-4 flex justify-center"></div>
      </div>

      <div class="flex justify-end">
        <button
          id="toStep2"
          class="px-4 py-2 bg-primary-500 text-white rounded hover:bg-primary-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
          disabled
        >
          Dalej <i class="fas fa-arrow-right ml-2"></i>
        </button>
      </div>
    </div>

    <!-- Krok 2: Edytor treści -->
    <div id="step2" class="hidden">
      <div class="mb-4">
        <button id="backToStep1" class="text-primary-400 hover:text-primary-300 flex items-center">
          <i class="fas fa-arrow-left mr-2"></i> Wróć do podstawowych informacji
        </button>
      </div>

      <!-- Toolbar edytora -->
      <div class="editor-toolbar">
        <div class="tool-group">
          <button id="undoBtn" title="Cofnij">
            <i class="fas fa-undo"></i>
          </button>
          <button id="redoBtn" title="Ponów">
            <i class="fas fa-redo"></i>
          </button>
        </div>

        <div class="tool-group">
          <button id="boldBtn" title="Pogrubienie">
            <i class="fas fa-bold"></i>
          </button>
          <button id="italicBtn" title="Kursywa">
            <i class="fas fa-italic"></i>
          </button>
          <button id="underlineBtn" title="Podkreślenie">
            <i class="fas fa-underline"></i>
          </button>
          <button id="strikeBtn" title="Przekreślenie">
            <i class="fas fa-strikethrough"></i>
          </button>
          <button id="clearFormatBtn" title="Wyczyść formatowanie">
            <i class="fas fa-eraser"></i>
          </button>
        </div>

        <div class="tool-group">
          <button id="alignLeft" title="Wyrównaj do lewej">
            <i class="fas fa-align-left"></i>
          </button>
          <button id="alignCenter" title="Wyśrodkuj">
            <i class="fas fa-align-center"></i>
          </button>
          <button id="alignRight" title="Wyrównaj do prawej">
            <i class="fas fa-align-right"></i>
          </button>
        </div>

        <div class="tool-group">
          <select id="fontFamily" title="Czcionka" class="px-2">
            <option value="Arial">Arial</option>
            <option value="Georgia">Georgia</option>
            <option value="Courier New">Courier New</option>
            <option value="Pacifico">Pacifico</option>
            <option value="Raleway">Raleway</option>
            <option value="Oswald">Oswald</option>
            <option value="Lora">Lora</option>
            <option value="Montserrat">Montserrat</option>
            <option value="Comic Neue">Comic Neue</option>
            <option value="Playfair Display">Playfair Display</option>
            <option value="Ubuntu">Ubuntu</option>
            <option value="Nunito">Nunito</option>
            <option value="Rubik">Rubik</option>
          </select>
        </div>

        <div class="tool-group">
          <select id="fontSize" title="Rozmiar czcionki" class="px-2">
            <option value="1">Mała</option>
            <option value="3" selected>Normalna</option>
            <option value="5">Duża</option>
            <option value="7">Bardzo duża</option>
          </select>
        </div>

        <div class="tool-group">
          <input type="color" id="textColor" title="Kolor tekstu" class="w-8 h-8 p-0">
        </div>

        <div class="tool-group">
          <button id="quoteBtn" title="Cytat">
            <i class="fas fa-quote-right"></i>
          </button>
          <button id="linkBtn" title="Wstaw link">
            <i class="fas fa-link"></i>
          </button>
          <button id="ulBtn" title="Lista punktowana">
            <i class="fas fa-list-ul"></i>
          </button>
          <button id="olBtn" title="Lista numerowana">
            <i class="fas fa-list-ol"></i>
          </button>
        </div>

        <div class="tool-group">
          <button id="insertImageHereBtn" title="Wstaw obraz">
            <i class="fas fa-image"></i>
          </button>
          <button id="insertVideoHereBtn" title="Wstaw wideo">
            <i class="fas fa-video"></i>
          </button>
          <button id="insertDividerBtn" title="Wstaw linię">
            <i class="fas fa-minus"></i>
          </button>
        </div>

        <div class="tool-group">
          <select id="dividerThickness" class="px-2">
            <option value="1">Cienka</option>
            <option value="2" selected>Średnia</option>
            <option value="4">Gruba</option>
          </select>
        </div>

        <div class="tool-group">
          <label class="flex items-center">Interlinia:</label>
          <select id="lineHeight" class="px-2">
            <option value="1">1</option>
            <option value="1.2">1.2</option>
            <option value="1.5" selected>1.5</option>
            <option value="2">2</option>
          </select>
        </div>
      </div>

      <!-- Edytor treści -->
      <div class="mb-6">
        <label class="block text-sm font-medium mb-2">Treść wpisu</label>
        <div
          id="blogContent"
          contenteditable="true"
          class="p-4 rounded bg-dark-200 min-h-[300px] border border-dark-400 focus:border-primary-500 focus:ring-1 focus:ring-primary-500"
        ></div>
      </div>

      <!-- Przyciski akcji -->
      <div class="flex justify-between">
        <button
          id="saveDraftBtn"
          class="px-4 py-2 bg-gray-600 text-gray-300 rounded hover:bg-gray-700 transition-colors"
        >
          <i class="fas fa-save mr-2"></i> Zapisz wersję roboczą
        </button>
        <button
          id="publishBtn"
          class="px-4 py-2 bg-primary-500 text-white rounded hover:bg-primary-600 transition-colors"
        >
          <i class="fas fa-paper-plane mr-2"></i> Opublikuj
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Overlay do edycji mediów -->
<div id="mediaEditorOverlay" class="media-editor hidden">
  <div class="flex items-center gap-2">
    <label>Szerokość:</label>
    <input type="number" id="mediaWidth" min="50" max="1000">
  </div>
  <div class="flex items-center gap-2">
    <label>Wysokość:</label>
    <input type="number" id="mediaHeight" min="50" max="1000">
  </div>
  <button id="applyMediaSize" class="mt-2 px-3 py-1 bg-primary-500 rounded hover:bg-primary-600">
    Zastosuj
  </button>
</div>

<!-- Skrypt JavaScript -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  // --- Elementy DOM ---
  const step1 = document.getElementById('step1');
  const step2 = document.getElementById('step2');
  const toStep2Btn = document.getElementById('toStep2');
  const backBtn = document.getElementById('backToStep1');
  const titleInput = document.getElementById('blogTitle');
  const descInput = document.getElementById('blogDesc');
  const coverInput = document.getElementById('coverUpload');
  const coverPreview = document.getElementById('coverPreview');
  const blogContent = document.getElementById('blogContent');
  const tagInput = document.getElementById('tagInput');
  const tagsContainer = document.getElementById('tagsContainer');
  const categorySelect = document.getElementById('blogCategory');
  const publishBtn = document.getElementById('publishBtn');
  const titleInputExists = !!titleInput;

  // --- Historia zmian dla undo/redo ---
  let history = [];
  let historyIndex = -1;

  // --- Funkcje pomocnicze ---
  function validateStep1() {
    toStep2Btn.disabled = !(titleInput.value.trim() && descInput.value.trim());
  }

  function saveState() {
    const content = blogContent.innerHTML;
    history = history.slice(0, historyIndex + 1);
    history.push(content);
    historyIndex = history.length - 1;
  }

  function execCmd(cmd, value = null) {
    document.execCommand(cmd, false, value);
    blogContent.focus();
    saveState();
  }

  function isJSONResponseOK(res) {
    return res.ok && res.headers.get('Content-Type')?.includes('application/json');
  }

  // --- Inicjalizacja ---
  validateStep1();

  // --- Obsługa kroku 1 ---
  titleInput.addEventListener('input', validateStep1);
  descInput.addEventListener('input', validateStep1);

  // Podgląd okładki
  coverInput.addEventListener('change', () => {
    const file = coverInput.files[0];
    const fileName = document.getElementById('coverFileName');
    if (file) {
      fileName.textContent = file.name;
      const reader = new FileReader();
      reader.onload = e => {
        coverPreview.innerHTML = `<img src="${e.target.result}" class="cover-preview rounded-md border border-gray-600">`;
      };
      reader.readAsDataURL(file);
    } else {
      fileName.textContent = 'Nie wybrano pliku';
      coverPreview.innerHTML = '';
    }
  });

  // Tagi
  tagInput.addEventListener('keypress', e => {
    if (e.key === 'Enter' && tagInput.value.trim()) {
      const tagText = tagInput.value.trim();
      const tagElement = document.createElement('div');
      tagElement.className = 'tag';
      tagElement.innerHTML = `
        ${tagText}
        <span class="tag-remove" data-tag="${tagText}">
          <i class="fas fa-times ml-1"></i>
        </span>
      `;
      tagsContainer.appendChild(tagElement);
      tagInput.value = '';
      tagElement.querySelector('.tag-remove').addEventListener('click', () => {
        tagElement.remove();
      });
    }
  });

  // Przejście do kroku 2
  toStep2Btn.addEventListener('click', () => {
    step1.classList.add('hidden');
    step2.classList.remove('hidden');
    blogContent.focus();
    saveState();
  });

  // Powrót do kroku 1
  backBtn.addEventListener('click', () => {
    step2.classList.add('hidden');
    step1.classList.remove('hidden');
  });

  // Undo / Redo
  document.getElementById('undoBtn').addEventListener('click', () => {
    if (historyIndex > 0) {
      historyIndex--;
      blogContent.innerHTML = history[historyIndex];
    }
  });
  document.getElementById('redoBtn').addEventListener('click', () => {
    if (historyIndex < history.length - 1) {
      historyIndex++;
      blogContent.innerHTML = history[historyIndex];
    }
  });

  // Formatowanie
  [
    { id: 'boldBtn', cmd: 'bold' },
    { id: 'italicBtn', cmd: 'italic' },
    { id: 'underlineBtn', cmd: 'underline' },
    { id: 'strikeBtn', cmd: 'strikeThrough' },
    { id: 'alignLeft', cmd: 'justifyLeft' },
    { id: 'alignCenter', cmd: 'justifyCenter' },
    { id: 'alignRight', cmd: 'justifyRight' },
    { id: 'clearFormatBtn', cmd: 'removeFormat' },
    { id: 'ulBtn', cmd: 'insertUnorderedList' },
    { id: 'olBtn', cmd: 'insertOrderedList' }
  ].forEach(btn => {
    document.getElementById(btn.id).addEventListener('click', () => execCmd(btn.cmd));
  });

  // Selecty formatowania
  [
    { id: 'fontFamily', cmd: 'fontName' },
    { id: 'fontSize', cmd: 'fontSize' },
    { id: 'textColor', cmd: 'foreColor' }
  ].forEach(sel => {
    document.getElementById(sel.id).addEventListener('change', e => execCmd(sel.cmd, e.target.value));
  });

  // Cytat
  document.getElementById('quoteBtn').addEventListener('click', () => {
    execCmd('formatBlock', '<blockquote>');
  });

  // Link
  document.getElementById('linkBtn').addEventListener('click', () => {
    const url = prompt('Podaj adres URL:', 'https://');
    if (url) execCmd('createLink', url);
  });

  // Linia pozioma
  document.getElementById('insertDividerBtn').addEventListener('click', () => {
    const thickness = document.getElementById('dividerThickness').value;
    execCmd('insertHTML', `<hr class="custom-divider" style="border-top:${thickness}px dashed #f59e0b;">`);
  });

  // Interlinia
  document.getElementById('lineHeight').addEventListener('change', e => {
    blogContent.style.lineHeight = e.target.value;
  });

  // Media w edytorze
  const mediaInput = document.createElement('input');
  mediaInput.type = 'file';
  mediaInput.accept = 'image/*,video/*';
  mediaInput.className = 'hidden';
  document.body.appendChild(mediaInput);
  let selectedMedia = null;
  const mediaEditor = document.getElementById('mediaEditorOverlay');

  document.getElementById('insertImageHereBtn').addEventListener('click', () => {
    mediaInput.accept = 'image/*';
    mediaInput.click();
  });
  document.getElementById('insertVideoHereBtn').addEventListener('click', () => {
    mediaInput.accept = 'video/*';
    mediaInput.click();
  });

  mediaInput.addEventListener('change', function() {
    const file = this.files[0];
    if (!file) return;
    const reader = new FileReader();
    reader.onload = e => {
      const isImage = file.type.startsWith('image/');
      const mediaHTML = isImage
        ? `<img src="${e.target.result}" class="media-element rounded-md mb-4 max-w-full">`
        : `<video src="${e.target.result}" controls class="media-element rounded-md mb-4 w-full"></video>`;
      execCmd('insertHTML', mediaHTML);
    };
    reader.readAsDataURL(file);
    this.value = '';
  });

  blogContent.addEventListener('click', e => {
    if (e.target.classList.contains('media-element')) {
      selectedMedia = e.target;
      document.getElementById('mediaWidth').value = selectedMedia.width || selectedMedia.offsetWidth;
      document.getElementById('mediaHeight').value = selectedMedia.height || selectedMedia.offsetHeight;
      const rect = selectedMedia.getBoundingClientRect();
      mediaEditor.style.top = `${rect.top}px`;
      mediaEditor.style.left = `${rect.left + rect.width + 10}px`;
      mediaEditor.classList.remove('hidden');
    }
  });

  document.getElementById('applyMediaSize').addEventListener('click', () => {
    if (selectedMedia) {
      selectedMedia.width = document.getElementById('mediaWidth').value;
      selectedMedia.height = document.getElementById('mediaHeight').value;
      mediaEditor.classList.add('hidden');
      selectedMedia = null;
      saveState();
    }
  });

  document.addEventListener('click', e => {
    if (!e.target.closest('#mediaEditorOverlay') && !e.target.classList.contains('media-element')) {
      mediaEditor.classList.add('hidden');
    }
  });

  // --- Zapisywanie wersji roboczej ---
  document.getElementById('saveDraftBtn').addEventListener('click', () => {
    const draft = {
      title: titleInput.value,
      description: descInput.value,
      content: blogContent.innerHTML,
      timestamp: new Date().toISOString()
    };
    localStorage.setItem('blogDraft', JSON.stringify(draft));
    alert('Wersja robocza zapisana pomyślnie!');
  });

  // --- Publikacja posta + newsletter ---
  publishBtn.addEventListener('click', async () => {
    // Walidacja
    if (!titleInput.value.trim() || !descInput.value.trim() || !blogContent.innerText.trim()) {
      alert('Proszę uzupełnić tytuł, opis i treść posta!');
      return;
    }

    // Przygotowanie postData
    const postData = {
      title: titleInput.value.trim(),
      description: descInput.value.trim(),
      timestamp: new Date().toISOString(),
      html: blogContent.innerHTML,
      media: [],
      tags: [],
      category: categorySelect.value
    };

    // Tagi
    tagsContainer.querySelectorAll('.tag').forEach(tag => {
      const text = tag.textContent.replace('×', '').trim();
      if (text) postData.tags.push(text);
    });

    // Media w Base64
    const parser = new DOMParser();
    const doc = parser.parseFromString(postData.html, 'text/html');
    const mediaEls = doc.querySelectorAll('img[src^="data:"], video[src^="data:"]');
    const formData = new FormData();
    let mediaIndex = 0;
    for (const el of mediaEls) {
      const src = el.getAttribute('src');
      const m = src.match(/^data:(.+?);base64,(.+)$/);
      if (!m) continue;
      const mime = m[1], b64 = m[2], ext = mime.split('/')[1];
      const id = `media_${Date.now()}_${mediaIndex}.${ext}`;
      const bytes = atob(b64);
      const arr = new Uint8Array(bytes.length);
      for (let i = 0; i < bytes.length; i++) arr[i] = bytes.charCodeAt(i);
      formData.append('media', new Blob([arr], { type: mime }), id);
      el.setAttribute('src', `media://${id}`);
      postData.media.push({ id, type: el.tagName.toLowerCase(), position: mediaIndex });
      mediaIndex++;
    }
    postData.html = doc.documentElement.innerHTML;

    // Okładka
    if (coverInput.files[0]) {
      formData.append('cover', coverInput.files[0]);
      postData.cover_image = coverInput.files[0].name;
    }

    formData.append('json', new Blob([JSON.stringify(postData)], { type: 'application/json' }));

    try {
      // 1️⃣ Wysyłka posta
      const res = await fetch('http://localhost:8127/api/upload-post', { method: 'POST', body: formData });
      if (!res.ok) {
        let msg = 'Błąd serwera';
        if (res.headers.get('Content-Type')?.includes('application/json')) {
          const err = await res.json();
          msg = err.error || err.message || msg;
        } else {
          msg = await res.text();
        }
        throw new Error(msg);
      }
      const result = await res.json();

      // 2️⃣ Newsletter
      await fetch('/send-newsletter', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          title: postData.title,
          description: postData.description,
          link: `https://jolatrener.pl/blog/${result.post_id}`
        })
      });

      alert(`Post opublikowany i newsletter wysłany! ID: ${result.post_id}`);

      // Reset formularza
      titleInput.value = '';
      descInput.value = '';
      blogContent.innerHTML = '';
      coverInput.value = '';
      coverPreview.innerHTML = '';
      document.getElementById('coverFileName').textContent = 'Nie wybrano pliku';
      tagsContainer.innerHTML = '';
      categorySelect.value = '';
      history = [];
      historyIndex = -1;
      step2.classList.add('hidden');
      step1.classList.remove('hidden');
      validateStep1();
    } catch (err) {
      console.error('Błąd publikacji:', err);
      alert(`Wystąpił błąd: ${err.message}`);
    }
  });
});
</script>

</body>
</html>